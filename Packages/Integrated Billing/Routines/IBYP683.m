IBYP683 ;ALB/CXW - IB*2.0*683 POST INIT: REASONABLE CHARGES V4.21 ; 08/31/2020
 ;;2.0;INTEGRATED BILLING;**683**;21-MAR-94;Build 74
 ;;Per VA Directive 6402, this routine should not be modified.
 Q
 ;
POST ;
 N IBA,U S U="^"
 D BMSG("    Reasonable Charges v4.21 Post-Install .....")
 D CHGINA("") ; inactivate all RC charges in #363.2
 D FTYPE ; change facility type from non-provider to provider based outpatient care in #363.31
 D BMSG("    Reasonable Charges v4.21 Post-Install Complete")
 Q
 ;
BMSG(IBA) ;
 D BMES^XPDUTL(IBA)
 Q
MSG(IBA) ;
 D MES^XPDUTL(IBA)
 Q
 ;
CHGINA(VERS) ; inactive charges from previous versions of Reasonable Charges
 ; VERS = version to begin inactivations with (1, 1.1, 1.2, ...)
 ; - Inactive date added is the first RC Version Inactive date after the effective date of the charge
 ; - if the charge already has an inactive date less than the Version Inactive Date then no change is made
 ;
 N IBA,IBI,IBX,IBSTART,IBENDATE,IBCS,IBCS0,IBBR0,IBXRF,IBITM,IBNEF,IBCI,IBCI0,IBCIEF,IBCIIA,IBNEWIA
 N DD,DO,DLAYGO,DIC,DIE,DA,DR,X,Y,IBCNT S IBCNT=0
 ;
 D BMSG("      >> Inactivating Existing Reasonable Charges, Please Wait...")
 ;
 S IBSTART="" I $G(VERS)'="" S IBSTART=$$VERSDT^IBCRHBRV(VERS)
 S IBENDATE=$$VERSEND^IBCRHBRV
 ;
 S IBCS=0 F  S IBCS=$O(^IBE(363.1,IBCS)) Q:'IBCS  D
 . S IBCS0=$G(^IBE(363.1,IBCS,0)) Q:IBCS0=""
 . S IBBR0=$G(^IBE(363.3,+$P(IBCS0,U,2),0)) I $E(IBBR0,1,3)'="RC " Q
 . ;
 . S IBXRF="AIVDTS"_IBCS
 . S IBITM=0 F  S IBITM=$O(^IBA(363.2,IBXRF,IBITM)) Q:'IBITM  D
 .. S IBNEF="" F  S IBNEF=$O(^IBA(363.2,IBXRF,IBITM,IBNEF)) Q:IBNEF=""  Q:-IBNEF<IBSTART  D
 ... ;
 ... S IBCI=0 F  S IBCI=$O(^IBA(363.2,IBXRF,IBITM,IBNEF,IBCI)) Q:'IBCI  D
 .... S IBCI0=$G(^IBA(363.2,IBCI,0)) Q:IBCI0=""
 .... S IBCIEF=$P(IBCI0,U,3),IBCIIA=$P(IBCI0,U,4),IBNEWIA=""
 .... ;
 .... F IBI=2:1 S IBX=+$P(IBENDATE,";",IBI) S IBNEWIA=IBX Q:'IBX  Q:IBCIEF'>IBX
 .... ;
 .... I 'IBNEWIA Q
 .... I +IBCIIA,IBCIIA'>IBNEWIA Q
 .... ;
 .... S DR=".04///"_+IBNEWIA,DIE="^IBA(363.2,",DA=+IBCI
 .... D ^DIE K DIE,DIC,DA,DR,X,Y S IBCNT=IBCNT+1
 ;
 D MSG("         Done.  "_IBCNT_" existing charges inactivated")
 Q
 ;
FTYPE ; change facility type of billing regions for 166 subdivisions
 N IBARY,IBCNT,IBI,IBLND,IBRIEN,IBSDV,DA,DIE,DR,X,Y S IBCNT=0
 D BMSG("      >> Updating Billing Regions with Provider Based Outpatient Care")
 F IBI=1:1 S IBLND=$P($T(NPBTX+IBI),";;",2) Q:IBLND="Q"  D
 . S IBSDV=$P(IBLND,",") Q:IBSDV=""
 . S ^TMP("IB683",$J,IBSDV,IBI)=""
 ; update type with 2 if match to the list
 S IBRIEN=0 F  S IBRIEN=$O(^IBE(363.31,IBRIEN)) Q:'IBRIEN  D
 . S IBLND=$G(^IBE(363.31,IBRIEN,0)) Q:IBLND=""
 . Q:$E(IBLND,1,3)'="RC "
 . S IBSDV=$P($P(IBLND,U)," ",2) Q:IBSDV=""
 . Q:'$D(^TMP("IB683",$J,IBSDV))
 . Q:$P(IBLND,U,3)=2
 . ;
 . S DIE="^IBE(363.31,",DA=IBRIEN,DR=".03///2"
 . D ^DIE K DIE,DR,DA,X,Y
 . S IBCNT=IBCNT+1,IBARY($P(IBLND,U))=""
 ;
 ; display region name by order
 S IBSDV="" F  S IBSDV=$O(IBARY(IBSDV)) Q:IBSDV=""  D MSG("         "_IBSDV)
 D MSG("         Done.  "_IBCNT_" facility type of billing regions changed")
 K ^TMP("IB683",$J)
 Q
 ;
NPBTX ; 166 Station #,VA Facility Location & State,Zip Code,NPB Type
 ;;402QA,"FT. KENT VA CLINIC, ME",047,3
 ;;405HA,"BURLINGTON LAKESIDE VA CLINIC, VT (CBOC)",054,3
 ;;405QB,"NEWPORT VA CLINIC, VT",058,3
 ;;436GK,"GLENDIVE VA CLINIC, MT",593,3
 ;;436GN,"DR. J MEDICINE CROW VA CLINIC, MT",591,3
 ;;436QA,"HAMILTON VA CLINIC, MT",598,3
 ;;436QB,"PLENTYWOOD VA CLINIC, MT",592,3
 ;;436QD,"BROWNING VA CLINIC, MT",594,3
 ;;437GB,"BISMARCK VA CLINIC, ND",585,3
 ;;437GJ,"DICKINSON VA CLINIC, ND",586,3
 ;;437GK,"JAMESTOWN VA CLINIC, ND",584,3
 ;;437GL,"DEVILS LAKE VA CLINIC, ND",583,3
 ;;442QD,"LARAMIE VA MOBILE CLINIC, WY",820,3
 ;;442QE,"STERLING VA CLINIC, CO",807,3
 ;;459GE,VA GUAM CBOC,969,3
 ;;459GH,SAIPAN VA CLINIC,969,3
 ;;459QA,"LANAI VA CLINIC, HI",967,3
 ;;459QB,"MOLOKAI VA CLINIC, HI",967,3
 ;;460GD,"CAPE MAY, NJ (CBOC)",082,3
 ;;460HE,"ATLANTIC COUNTY VA CLINIC, NJ",082,3
 ;;463GA,"FAIRBANKS VA CLINIC, AK",997,3
 ;;463GD,"HOMER VA CLINIC, AK",996,3
 ;;463GE,"JUNEAU VA CLINIC, AK",998,3
 ;;501GN,"TAOS VA CLINIC, NM",875,3
 ;;502GE,"DOUGLAS FOURNET VA CLINIC, LA",706,3
 ;;502QB,"LAFAYETTE CAMPUS B VA CLINIC, LA",705,3
 ;;508GL,"ROME VA CLINIC, GA",301,3
 ;;508GM,"PICKENS COUNTY VA CLINIC, GA",301,3
 ;;509QA,"RAY HENDRIX VA CLINIC, GA",304,3
 ;;512GE,"POCOMOKE CITY VA CLINIC, MD",218,3
 ;;515QA,"LANSING NORTH VA CLINIC, MI",489,3
 ;;515QB,"CENTURY AVENUE VA CLINIC, MI",495,3
 ;;520GB,"PANAMA CITY BEACH VA CLINIC, FL",324,3
 ;;520QA,"PANAMA CITY BEACH WEST VA CLIN, FL",324,3
 ;;523GD,"PLYMOUTH VA CLINIC, MA",023,3
 ;;528QE,"COUDERSPORT VA CLINIC, NY",169,3
 ;;528QF,"WELLSBORO VA CLINIC, NY",169,3
 ;;528QK,"SARANAC LAKE VA CLINIC, NY",129,3
 ;;528QN,"WATERTOWN 2 VA CLINIC, NY",136,3
 ;;531GH,"EASTERN OREGON VA CLINIC, OR",977,3
 ;;531GI,"MOUNTAIN HOME VA CLINIC, ID",836,3
 ;;531GJ,"SALMON VA CLINIC, ID",834,3
 ;;531JA,"SALMON ORC, ID",834,3
 ;;531JB,"BURNS ORC, OR",977,3
 ;;534QA,"MARKET COMMONS VA CLINIC, SC",295,3
 ;;538GF,"WILMINGTON VA CLINIC, OH",451,3
 ;;546GH,"DEERFIELD BEACH VA CLINIC, FL",334,3
 ;;548QA,"PORT SAINT LUCIE VA CLINIC, FL",349,3
 ;;549GJ,"SHERMAN VA CLINIC, TX",750,3
 ;;550GG,"BLOOMINGTON VA CLINIC, IL",617,3
 ;;554GE,"FLOYD K. LINDSTROM VA CLINIC (CBOC), CO",809,3
 ;;554QC,"SALIDA VA CLINIC, CO",812,3
 ;;557GF,"TIFTON VA CLINIC, GA",317,3
 ;;558GH,"CLAYTON-EAST RALEIGH VA CLINIC, NC",275,3
 ;;561GK,"SUSSEX VA CLINIC, NJ",078,3
 ;;564GF,"JOPLIN VA CLINIC, MO",648,3
 ;;565GA,"JACKSONVILLE VA CLINIC, NC",285,3
 ;;565GC,"WILMINGTON VA CLINIC, NC",284,3
 ;;565GH,"BRUNSWICK COUNTY VA CLINIC, NC",284,3
 ;;565GJ,"JACKSONVILLE 2 VA CLINIC, NC",285,3
 ;;565GM,"JACKSONVILLE 3 VA CLINIC, NC",285,3
 ;;565GN,"JACKSONVILLE 4 VA CLINIC, NC",285,3
 ;;568HB,"GORDON VA CLINIC, NE",693,3
 ;;568HH,"SCOTTSBLUFF VA CLINIC, NE",693,3
 ;;568HJ,"MISSION VA CLINIC, SD",575,3
 ;;568HP,"WINNER VA CLINIC, SD",575,3
 ;;573GF,"SGT E.I. BOOTS THOMAS VA CLIN, FL",323,3
 ;;573GK,"MARIANNA VA CLINIC, FL",324,3
 ;;573GM,"WAYCROSS VA CLINIC, GA",315,3
 ;;573GO,"MIDDLEBURG VA CLINIC, FL",320,3
 ;;573QG,"JACKSONVILLE SOUTHPOINT VA CLINIC, FL",322,3
 ;;573QK,"LAKE CITY VA CLINIC, FL",320,3
 ;;575QA,"GLENWOOD SPRINGS VA CLINIC, CO",816,3
 ;;575QB,"MOAB VA CLINIC, UT",845,3
 ;;581GH,"LENORE VA CLINIC, WV",256,3
 ;;583GE,"WEST LAFAYETTE VA CLINIC, IN",479,3
 ;;583QA,"MONROE COUNTY VA CLINIC, IN",474,3
 ;;583QC,"VIGO COUNTY VA CLINIC, IN",478,3
 ;;583QF,"CRANE VA CLINIC, IN",475,3
 ;;585GF,"MANISTIQUE VA CLINIC, MI",498,3
 ;;585GG,"GLADSTONE VA CLINIC, MI",498,3
 ;;589G9,"FORT RILEY VA CLINIC, KS ",664,3
 ;;596GA,"SOMERSET VA CLINIC, KY",425,3
 ;;596GB,"MOREHEAD VA CLINIC, KY",403,3
 ;;596GC,"HAZARD VA CLINIC, KY ",417,3
 ;;605QA,"BLYTHE VA CLINIC, CA",922,3
 ;;610BY,"ST. JOSEPH COUNTY VA CLINIC, IN",465,3
 ;;610GC,"GOSHEN VA CLINIC, IN",465,3
 ;;610QB,"COLUMBIA PLACE VA CLINIC, IN",466,3
 ;;612B4,"REDDING VA CLINIC, CA",960,3
 ;;612GG,"CHICO VA CLINIC, CA",959,3
 ;;612GI,"YUBA CITY VA CLINIC, CA",959,3
 ;;612GJ,"YREKA VA CLINIC, CA",960,3
 ;;612QB,"TWENTY FIRST STREET VA CLINIC, CA",946,3
 ;;612QC,"CYPRESS AVENUE VA CLINIC, CA",960,3
 ;;618GM,"RICE LAKE VA CLINIC, WI",548,3
 ;;618GN,"LYLE C. PEARSON CBOC, MN",560,3
 ;;618QB,"ELY VA CLINIC, MN",557,3
 ;;619GA,"COLUMBUS VA CLINIC, GA",319,3
 ;;619QA,"DOTHAN 2 VA CLINIC, AL",363,3
 ;;619QB,"FORT BENNING VA CLINIC, GA",319,3
 ;;620GE,"PORT JERVIS VA CLINIC, NY",127,3
 ;;620GF,"MONTICELLO VA CLINIC, NY",127,3
 ;;620GH,"EASTERN DUTCHESS VA CLINIC, NY",125,3
 ;;621QA,"JONESVILLE VA CLINIC, VA",242,3
 ;;621QB,"MARION VA CLINIC, VA",243,3
 ;;621QC,"VANSANT VA CLINIC, VA",246,3
 ;;621QD,"KNOX COUNTY VA CLINIC, TN",379,3
 ;;621QE,"DOWNTOWN WEST VA CLINIC, TN",379,3
 ;;623GC,"MC CURTAIN COUNTY VA CLINIC, OK",747,3
 ;;623QB,"TULSA ELEVENTH STREET VA CLINIC, OK",741,3
 ;;626GF,"CHATTANOOGA VA CLINIC, TN",374,3
 ;;626GG,"TULLAHOMA VA CLINIC, TN",373,3
 ;;626GK,"MCMINNVILLE VA CLINIC, TN",371,3
 ;;626GL,"ROANE COUNTY VA CLINIC, TN",377,3
 ;;626QC,"POINTE CENTRE VA CLINIC, TN",374,3
 ;;626QF,"DALTON DRIVE VA CLINIC, TN",370,3
 ;;629QA,"BATON ROUGE SOUTH VA CLINIC, LA",708,3
 ;;631QB,"LAKE AVENUE VA CLINIC, MA",016,3
 ;;635GH,"CLINTON VA CLINIC, OK",736,3
 ;;635QD,"LAWTON NORTH VA CLINIC, OK",735,3
 ;;636GX,"FORT DODGE NORTH VA CLINIC, IA",505,3
 ;;636QD,"MACOMB VA CLINIC, IL",614,3
 ;;636QI,"DAVENPORT VA CLINIC, IA",528,3
 ;;648GH,"NEWPORT VA CLINIC, OR",973,3
 ;;648GJ,"LOREN R. KAUFMAN VA CLINIC, OR",970,3
 ;;648GK,"LINCOLN CITY VA CLINIC, OR",973,3
 ;;649QA,"CHINLE VA CLINIC, AZ",865,3
 ;;649QB,"HOLBROOK VA CLINIC, AZ",860,3
 ;;649QD,"PAGE VA CLINIC, AZ",860,3
 ;;649QF,"TUBA CITY VA CLINIC, AZ",860,3
 ;;649QG,"POLACCA VA CLINIC, AZ",860,3
 ;;649QH,"KAYENTA VA CLINIC, AZ",860,3
 ;;653QA,"DOWNTOWN EUGENE VA CLINIC, OR",974,3
 ;;654QC,"WINNEMUCCA VA CLINIC, NV",894,3
 ;;657GW,"POCAHONTAS VA CLINIC, AR",724,3
 ;;660QA,"IDAHO FALLS VA CLINIC, ID",834,3
 ;;660QB,"PRICE VA CLINIC, UT",845,3
 ;;660QD,"CACHE VALLEY VA CLINIC, UT",843,3
 ;;663GE,"NORTH OLYMPIC PENINSULA VA CLINIC, WA",983,3
 ;;663JA,"PORT ANGELES, WA",983,3
 ;;666QA,"AFTON VA CLINIC, WY",831,3
 ;;666QB,"EVANSTON VA CLINIC, WY",829,3
 ;;666QC,"WORLAND VA CLINIC, WY",824,3
 ;;668QB,"LIBBY VA CLINIC, MT",599,3
 ;;668QD,"SANDPOINT VA CLINIC, ID",838,3
 ;;671QA,"SOUTH TEXAS VA MOBILE CLINIC, TX",780,3
 ;;672QB,"UTUADO VA CLINIC, PR",006,3
 ;;672QC,"VIEQUES VA CLINIC, PR",007,3
 ;;673GH,"LECANTO VA CLINIC, FL",344,3
 ;;675GB,"WILLIAM V. CHAPPELL, JR. VOC, FL",321,3
 ;;675QB,"PORT ORANGE VA CLINIC, FL",321,3
 ;;675QC,"WESTSIDE PAVILION VA CLINIC, FL",321,3
 ;;675QG,"PALM BAY VA CLINIC, FL",329,3
 ;;678QA,"COCHISE COUNTY VA CLINIC, AZ",856,3
 ;;678QB,"PINAL COUNTY VA CLINIC, AZ",851,3
 ;;679GA,"SELMA VA CLINIC, AL",367,3
 ;;687QB,"MORROW COUNTY VA CLINIC, OR",978,3
 ;;687QC,"WALLOWA COUNTY VA CLINIC, OR",978,3
 ;;688GG,"LEXINGTON PARK VA CLINIC, MD",206,3
 ;;693QA,"WAYNE COUNTY VA CLINIC, PA",184,3
 ;;695GD,"MILO C. HUEMPFNER VA OPC, WI",543,3
 ;;740GC,"CORPUS CHRISTI CBOC, TX",784,3
 ;;740GD,"LAREDO CBOC, TX",780,3
 ;;740GH,"SOUTH ENTERPRIZE VA CLINIC, TX",784,3
 ;;740GI,"OLD BROWNSVILLE VA CLINIC, TX",784,3
 ;;Q

KMPPST3C ;SP/JML - VSM VERSION 2 POST INSTALL ROUTINE ;6/1/2020
 ;;4.0;CAPACITY MANAGEMENT;**1**;3/1/2018;Build 27
 ;
GETPAT(MDEF) ;
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP GetPatientListEvent"")")
 D MDEF.Implementation.WriteLine("    N $ETRAP S $ETRAP=""D ^ZTER D RU^%ZOSVKR(""""KMP GetPatientList"""") Q""")
 D MDEF.Implementation.WriteLine("    I $P($$VERSION^%ZOSV(0),""."") < 2017 Q $$$ERROR(""Invalid Cache Version"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Access-Control-Allow-Origin"",""*"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Allow"",""HEAD,GET,POST,PUT,DELETE,OPTIONS"")")
 D MDEF.Implementation.WriteLine("    S KMPRET=##class(%DynamicObject).%New()")
 D MDEF.Implementation.WriteLine("    S KMPREQ=##class(%DynamicAbstractObject).%FromJSON(%request.Content)")
 D MDEF.Implementation.WriteLine("    I KMPREQ.Function'=""GetPatientList"" D  Quit $$$OK")
 D MDEF.Implementation.WriteLine("    .S KMPRET.ResultText=""Incorrect Function Type""")
 D MDEF.Implementation.WriteLine("    .W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D SITE^KMPUTLW(KMPRET)")
 D MDEF.Implementation.WriteLine("    D PATLIST^KMPSYNTH(KMPRET,KMPREQ.Count)")
 D MDEF.Implementation.WriteLine("    S KMPRET.Function=KMPREQ.Function")
 D MDEF.Implementation.WriteLine("    W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP GetPatientListHandler"")")
 D MDEF.Implementation.WriteLine("    Quit $$$OK")
 Q
 ;
IMALIVE(MDEF) ;
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP ImAliveEvent"")")
 D MDEF.Implementation.WriteLine("    N $ETRAP S $ETRAP=""D ^ZTER D RU^%ZOSVKR(""""KMP ImAlive"""") Q""")
 D MDEF.Implementation.WriteLine("    I $P($$VERSION^%ZOSV(0),""."") < 2017 Q $$$ERROR(""Invalid Cache Version"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Access-Control-Allow-Origin"",""*"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Allow"",""HEAD,GET,POST,PUT,DELETE,OPTIONS"")")
 D MDEF.Implementation.WriteLine("    S KMPRET=##class(%DynamicObject).%New()")
 D MDEF.Implementation.WriteLine("    S KMPREQ=##class(%DynamicAbstractObject).%FromJSON(%request.Content)")
 D MDEF.Implementation.WriteLine("    I KMPREQ.Function'=""ImAlive"" D  Quit $$$OK")
 D MDEF.Implementation.WriteLine("    .S KMPRET.ResultText=""Incorrect Function Type""")
 D MDEF.Implementation.WriteLine("    .W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D SITE^KMPUTLW(KMPRET)")
 D MDEF.Implementation.WriteLine("    S KMPRET.Function=KMPREQ.Function")
 D MDEF.Implementation.WriteLine("    S KMPRET.ResultText=""OK""")
 D MDEF.Implementation.WriteLine("    W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP ImAliveHandler"")")
 D MDEF.Implementation.WriteLine("    Quit $$$OK")
 Q
 ;
SYNRCMD(MDEF) ;
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP SynthRcmdEvent"")")
 D MDEF.Implementation.WriteLine("    N $ETRAP S $ETRAP=""D ^ZTER D RU^%ZOSVKR(""""KMP SynthRcmd"""") Q""")
 D MDEF.Implementation.WriteLine("    I $P($$VERSION^%ZOSV(0),""."") < 2017 Q $$$ERROR(""Invalid Cache Version"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Access-Control-Allow-Origin"",""*"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Allow"",""HEAD,GET,POST,PUT,DELETE,OPTIONS"")")
 D MDEF.Implementation.WriteLine("    S KMPRET=##class(%DynamicObject).%New()")
 D MDEF.Implementation.WriteLine("    S KMPREQ=##class(%DynamicAbstractObject).%FromJSON(%request.Content)")
 D MDEF.Implementation.WriteLine("    I KMPREQ.Function'=""SynthRcmd"" D  Quit $$$OK")
 D MDEF.Implementation.WriteLine("    .S KMPRET.ResultText=""Incorrect Function Type""")
 D MDEF.Implementation.WriteLine("    .W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D SITE^KMPUTLW(KMPRET)")
 D MDEF.Implementation.WriteLine("    D SYNRCMD^KMPSYNTH(KMPRET)")
 D MDEF.Implementation.WriteLine("    S KMPRET.Function=KMPREQ.Function")
 D MDEF.Implementation.WriteLine("    S KMPRET.ResultText=""OK""")
 D MDEF.Implementation.WriteLine("    W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP SynthRcmdHandler"")")
 D MDEF.Implementation.WriteLine("    Quit $$$OK")
 Q
 ;
SYNGBL(MDEF) ;
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP SynthGblEvent"")")
 D MDEF.Implementation.WriteLine("    N $ETRAP S $ETRAP=""D ^ZTER D RU^%ZOSVKR(""""KMP SynthGbl"""") Q""")
 D MDEF.Implementation.WriteLine("    I $P($$VERSION^%ZOSV(0),""."") < 2017 Q $$$ERROR(""Invalid Cache Version"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Access-Control-Allow-Origin"",""*"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Allow"",""HEAD,GET,POST,PUT,DELETE,OPTIONS"")")
 D MDEF.Implementation.WriteLine("    S KMPRET=##class(%DynamicObject).%New()")
 D MDEF.Implementation.WriteLine("    S KMPREQ=##class(%DynamicAbstractObject).%FromJSON(%request.Content)")
 D MDEF.Implementation.WriteLine("    I KMPREQ.Function'=""SynthGbl"" D  Quit $$$OK")
 D MDEF.Implementation.WriteLine("    .S KMPRET.ResultText=""Incorrect Function Type""")
 D MDEF.Implementation.WriteLine("    .W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D SITE^KMPUTLW(KMPRET)")
 D MDEF.Implementation.WriteLine("    D SYNGBL^KMPSYNTH(KMPRET)")
 D MDEF.Implementation.WriteLine("    S KMPRET.Function=KMPREQ.Function")
 D MDEF.Implementation.WriteLine("    S KMPRET.ResultText=""OK""")
 D MDEF.Implementation.WriteLine("    W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP SynthGblHandler"")")
 D MDEF.Implementation.WriteLine("    Quit $$$OK")
 Q
 ;
SYNFILE(MDEF) ;
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP SynthFileEvent"")")
 D MDEF.Implementation.WriteLine("    N $ETRAP S $ETRAP=""D ^ZTER D RU^%ZOSVKR(""""KMP SynthFile"""") Q""")
 D MDEF.Implementation.WriteLine("    I $P($$VERSION^%ZOSV(0),""."") < 2017 Q $$$ERROR(""Invalid Cache Version"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Access-Control-Allow-Origin"",""*"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Allow"",""HEAD,GET,POST,PUT,DELETE,OPTIONS"")")
 D MDEF.Implementation.WriteLine("    S KMPRET=##class(%DynamicObject).%New()")
 D MDEF.Implementation.WriteLine("    S KMPREQ=##class(%DynamicAbstractObject).%FromJSON(%request.Content)")
 D MDEF.Implementation.WriteLine("    I KMPREQ.Function'=""SynthFile"" D  Quit $$$OK")
 D MDEF.Implementation.WriteLine("    .S KMPRET.ResultText=""Incorrect Function Type""")
 D MDEF.Implementation.WriteLine("    .W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D SITE^KMPUTLW(KMPRET)")
 D MDEF.Implementation.WriteLine("    D SYNFILE^KMPSYNTH(KMPRET)")
 D MDEF.Implementation.WriteLine("    S KMPRET.Function=KMPREQ.Function")
 D MDEF.Implementation.WriteLine("    S KMPRET.ResultText=""OK""")
 D MDEF.Implementation.WriteLine("    W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP SynthFileHandler"")")
 D MDEF.Implementation.WriteLine("    Quit $$$OK")
 Q
 ;
SYNVPR(MDEF) ;
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP SynthVprEvent"")")
 D MDEF.Implementation.WriteLine("    N $ETRAP S $ETRAP=""D ^ZTER D RU^%ZOSVKR(""""KMP SynthVpr"""") Q""")
 D MDEF.Implementation.WriteLine("    I $P($$VERSION^%ZOSV(0),""."") < 2017 Q $$$ERROR(""Invalid Cache Version"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Access-Control-Allow-Origin"",""*"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Allow"",""HEAD,GET,POST,PUT,DELETE,OPTIONS"")")
 D MDEF.Implementation.WriteLine("    S KMPRET=##class(%DynamicObject).%New()")
 D MDEF.Implementation.WriteLine("    S KMPREQ=##class(%DynamicAbstractObject).%FromJSON(%request.Content)")
 D MDEF.Implementation.WriteLine("    I KMPREQ.Function'=""SynthVpr"" D  Quit $$$OK")
 D MDEF.Implementation.WriteLine("    .S KMPRET.ResultText=""Incorrect Function Type""")
 D MDEF.Implementation.WriteLine("    .W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D SITE^KMPUTLW(KMPRET)")
 D MDEF.Implementation.WriteLine("    D SYNVPR^KMPSYNTH(KMPRET)")
 D MDEF.Implementation.WriteLine("    S KMPRET.Function=KMPREQ.Function")
 D MDEF.Implementation.WriteLine("    S KMPRET.ResultText=""OK""")
 D MDEF.Implementation.WriteLine("    W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP SynthVprHandler"")")
 D MDEF.Implementation.WriteLine("    Quit $$$OK")
 Q
 ;
GETERR(MDEF) ;
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP GetErrorEvent"")")
 D MDEF.Implementation.WriteLine("    N $ETRAP S $ETRAP=""D ^ZTER D RU^%ZOSVKR(""""KMP GetError"""") Q""")
 D MDEF.Implementation.WriteLine("    I $P($$VERSION^%ZOSV(0),""."") < 2017 Q $$$ERROR(""Invalid Cache Version"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Access-Control-Allow-Origin"",""*"")")
 D MDEF.Implementation.WriteLine("    Do %response.SetHeader(""Allow"",""HEAD,GET,POST,PUT,DELETE,OPTIONS"")")
 D MDEF.Implementation.WriteLine("    S KMPRET=##class(%DynamicObject).%New()")
 D MDEF.Implementation.WriteLine("    S KMPREQ=##class(%DynamicAbstractObject).%FromJSON(%request.Content)")
 D MDEF.Implementation.WriteLine("    I KMPREQ.Function'=""GetError"" D  Quit $$$OK")
 D MDEF.Implementation.WriteLine("    .S KMPRET.ResultText=""Incorrect Function Type""")
 D MDEF.Implementation.WriteLine("    .W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D GETERR^KMPUTLW2(KMPRET,KMPREQ)")
 D MDEF.Implementation.WriteLine("    D SITE^KMPUTLW(KMPRET)")
 D MDEF.Implementation.WriteLine("    S KMPRET.ResultText=""OK""")
 D MDEF.Implementation.WriteLine("    S KMPRET.Function=KMPREQ.Function")
 D MDEF.Implementation.WriteLine("    W KMPRET.%ToJSON()")
 D MDEF.Implementation.WriteLine("    D RU^%ZOSVKR(""KMP GetErrorsHandler"")")
 D MDEF.Implementation.WriteLine("    Quit $$$OK")
 Q
